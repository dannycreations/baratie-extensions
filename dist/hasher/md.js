!function(){"use strict";class e{constructor(e={}){this.unitSize=1,this.unitOrder=0,this.blockSize=16,this.blockSizeInBytes=this.blockSize*this.unitSize,this.options=e,this.state={message:new Uint8Array(0),length:0},this.reset()}reset(){this.state.message=new Uint8Array(0),this.state.length=0}getState(){const e={...this.state};return e.message=new Uint8Array(this.state.message),e}setState(e){this.state={...e,message:new Uint8Array(e.message)}}update(e){const s=new Uint8Array(this.state.message.length+e.length);s.set(this.state.message),s.set(e,this.state.message.length),this.state.message=s,this.state.length+=e.length,this.process()}addPaddingPKCS7(e){const s=new Uint8Array(e).fill(e),t=new Uint8Array(this.state.message.length+s.length);t.set(this.state.message),t.set(s,this.state.message.length),this.state.message=t}addPaddingISO7816(e){const s=new Uint8Array(e);s[0]=128;const t=new Uint8Array(this.state.message.length+s.length);t.set(this.state.message),t.set(s,this.state.message.length),this.state.message=t}addPaddingZero(e){const s=new Uint8Array(e).fill(0),t=new Uint8Array(this.state.message.length+s.length);t.set(this.state.message),t.set(s,this.state.message.length),this.state.message=t}}class s extends e{constructor(e={}){super(e),this.unitSize=1,this.unitOrder=0,this.blockSizeInBytes=this.blockSize*this.unitSize}process(){for(;this.state.message.length>=this.blockSizeInBytes;){const e=this.state.message.slice(0,this.blockSizeInBytes);this.state.message=this.state.message.slice(this.blockSizeInBytes),this.processBlock(e)}}}const t=new Uint8Array([41,46,67,201,162,216,124,1,61,54,84,161,236,240,6,19,98,167,5,243,192,199,115,140,152,147,43,217,188,76,130,202,30,155,87,60,253,212,224,22,103,66,111,24,138,23,229,18,190,78,196,214,218,158,222,73,160,251,245,142,187,47,238,122,169,104,121,145,21,178,7,63,148,194,16,137,11,34,95,33,128,127,93,154,90,144,50,39,53,62,204,231,191,247,151,3,255,25,48,179,72,165,181,209,215,94,146,42,172,86,170,198,79,184,56,210,150,164,125,182,118,252,107,226,156,116,4,241,69,157,112,89,100,113,135,32,134,91,207,101,230,45,168,2,27,96,37,173,174,176,185,246,28,70,97,105,52,64,126,15,85,71,163,35,221,81,175,58,195,92,249,206,186,197,234,38,44,83,13,110,133,40,132,9,211,223,205,244,65,129,77,82,106,220,55,200,108,193,171,250,36,225,123,8,12,189,177,74,120,136,149,139,227,99,232,109,233,203,213,254,59,0,29,57,242,239,183,14,102,88,208,228,166,119,114,248,235,117,75,10,49,68,80,180,143,237,31,26,219,153,141,51,159,17,131,20]);class n extends s{constructor(e={}){super({...e,rounds:e.rounds||18}),this.reset()}reset(){super.reset(),this.state.hash=new Uint8Array(48),this.state.checksum=new Uint8Array(16)}finalize(){this.addPaddingPKCS7(16-(15&this.state.message.length)|0),this.process(),this.update(this.state.checksum);return this.state.hash.slice(0,16)}processBlock(e){for(let t=0;t<16;t++)this.state.hash[16+t]=0|e[t],this.state.hash[32+t]=e[t]^this.state.hash[t];let s=0;for(let n=0;n<this.options.rounds;n++){for(let e=0;e<48;e++)s=this.state.hash[e]^=t[s];s=s+n&255}s=255&this.state.checksum[15];for(let n=0;n<16;n++)s=this.state.checksum[n]^=t[e[n]^s]}}class r extends e{constructor(e={}){super(e),this.unitSize=4,this.unitOrder=0,this.blockSizeInBytes=this.blockSize*this.unitSize,this.blockUnits=new Uint32Array(this.blockSizeInBytes/this.unitSize)}process(){const e=this.blockSizeInBytes,s=this.blockUnits.length;for(;this.state.message.length>=e;){for(let e=0;e<s;e++){const s=4*e;this.blockUnits[e]=(this.state.message[s]|this.state.message[s+1]<<8|this.state.message[s+2]<<16|this.state.message[s+3]<<24)>>>0}this.state.message=this.state.message.slice(e),this.processBlock(this.blockUnits)}}addLengthBits(){const e=this.state.length,s=new Uint8Array(8);s[0]=e<<3&255,s[1]=e>>5&255,s[2]=e>>13&255,s[3]=e>>21&255,s[4]=e>>29&255,s[5]=0,s[6]=0,s[7]=0;const t=new Uint8Array(this.state.message.length+s.length);t.set(this.state.message),t.set(s,this.state.message.length),this.state.message=t}}function a(e,s){return e<<s|e>>>32-s}const o=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],l=1518500249,i=1859775393;class c extends r{static transformRoundOne(e,s,t){return e&s|~e&t}static transformRoundTwo(e,s,t){return e&s|e&t|s&t}static transformRoundThree(e,s,t){return e^s^t}static calculateCompressionCycle(e,s,t,n,r,o,l,i){return a(t+e(n,r,o)+l+s|0,i)}reset(){super.reset(),this.state.hash=new Uint32Array([1732584193,4023233417,2562383102,271733878])}finalize(){const e=this.state.message.length,s=e<56?56-e|0:120-e|0;return this.addPaddingISO7816(s),this.addLengthBits(),this.process(),new Uint8Array(this.state.hash.buffer)}processBlock(e){let s=this.state.hash[0],t=this.state.hash[1],n=this.state.hash[2],r=this.state.hash[3];const[a,h,u]=o;for(let o=0;o<16;o++){const l=a[o%4],i=e[o];o%4==0?s=c.calculateCompressionCycle(c.transformRoundOne,0,s,t,n,r,i,l):o%4==1?r=c.calculateCompressionCycle(c.transformRoundOne,0,r,s,t,n,i,l):o%4==2?n=c.calculateCompressionCycle(c.transformRoundOne,0,n,r,s,t,i,l):t=c.calculateCompressionCycle(c.transformRoundOne,0,t,n,r,s,i,l)}const m=[0,4,8,12,1,5,9,13,2,6,10,14,3,7,11,15];for(let o=0;o<16;o++){const a=h[o%4],i=e[m[o]];o%4==0?s=c.calculateCompressionCycle(c.transformRoundTwo,l,s,t,n,r,i,a):o%4==1?r=c.calculateCompressionCycle(c.transformRoundTwo,l,r,s,t,n,i,a):o%4==2?n=c.calculateCompressionCycle(c.transformRoundTwo,l,n,r,s,t,i,a):t=c.calculateCompressionCycle(c.transformRoundTwo,l,t,n,r,s,i,a)}const d=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15];for(let o=0;o<16;o++){const a=u[o%4],l=e[d[o]];o%4==0?s=c.calculateCompressionCycle(c.transformRoundThree,i,s,t,n,r,l,a):o%4==1?r=c.calculateCompressionCycle(c.transformRoundThree,i,r,s,t,n,l,a):o%4==2?n=c.calculateCompressionCycle(c.transformRoundThree,i,n,r,s,t,l,a):t=c.calculateCompressionCycle(c.transformRoundThree,i,t,n,r,s,l,a)}this.state.hash[0]=this.state.hash[0]+s|0,this.state.hash[1]=this.state.hash[1]+t|0,this.state.hash[2]=this.state.hash[2]+n|0,this.state.hash[3]=this.state.hash[3]+r|0}}const h=[[7,12,17,22],[5,9,14,20],[4,11,16,23],[6,10,15,21]],u=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);class m extends r{static transformRoundOne(e,s,t){return e&s|~e&t}static transformRoundTwo(e,s,t){return e&t|s&~t}static transformRoundThree(e,s,t){return e^s^t}static transformRoundFour(e,s,t){return s^(e|~t)}static calculateCompressionCycle(e,s,t,n,r,o,l,i){return a(t+e(n,r,o)+l+s,i)+n|0}reset(){super.reset(),this.state.hash=new Uint32Array([1732584193,4023233417,2562383102,271733878])}finalize(){const e=this.state.message.length,s=e<56?56-e|0:120-e|0;return this.addPaddingISO7816(s),this.addLengthBits(),this.process(),new Uint8Array(this.state.hash.buffer)}processBlock(e){let s=this.state.hash[0],t=this.state.hash[1],n=this.state.hash[2],r=this.state.hash[3];const[a,o,l,i]=h;s=m.calculateCompressionCycle(m.transformRoundOne,u[0],s,t,n,r,e[0],a[0]),r=m.calculateCompressionCycle(m.transformRoundOne,u[1],r,s,t,n,e[1],a[1]),n=m.calculateCompressionCycle(m.transformRoundOne,u[2],n,r,s,t,e[2],a[2]),t=m.calculateCompressionCycle(m.transformRoundOne,u[3],t,n,r,s,e[3],a[3]),s=m.calculateCompressionCycle(m.transformRoundOne,u[4],s,t,n,r,e[4],a[0]),r=m.calculateCompressionCycle(m.transformRoundOne,u[5],r,s,t,n,e[5],a[1]),n=m.calculateCompressionCycle(m.transformRoundOne,u[6],n,r,s,t,e[6],a[2]),t=m.calculateCompressionCycle(m.transformRoundOne,u[7],t,n,r,s,e[7],a[3]),s=m.calculateCompressionCycle(m.transformRoundOne,u[8],s,t,n,r,e[8],a[0]),r=m.calculateCompressionCycle(m.transformRoundOne,u[9],r,s,t,n,e[9],a[1]),n=m.calculateCompressionCycle(m.transformRoundOne,u[10],n,r,s,t,e[10],a[2]),t=m.calculateCompressionCycle(m.transformRoundOne,u[11],t,n,r,s,e[11],a[3]),s=m.calculateCompressionCycle(m.transformRoundOne,u[12],s,t,n,r,e[12],a[0]),r=m.calculateCompressionCycle(m.transformRoundOne,u[13],r,s,t,n,e[13],a[1]),n=m.calculateCompressionCycle(m.transformRoundOne,u[14],n,r,s,t,e[14],a[2]),t=m.calculateCompressionCycle(m.transformRoundOne,u[15],t,n,r,s,e[15],a[3]),s=m.calculateCompressionCycle(m.transformRoundTwo,u[16],s,t,n,r,e[1],o[0]),r=m.calculateCompressionCycle(m.transformRoundTwo,u[17],r,s,t,n,e[6],o[1]),n=m.calculateCompressionCycle(m.transformRoundTwo,u[18],n,r,s,t,e[11],o[2]),t=m.calculateCompressionCycle(m.transformRoundTwo,u[19],t,n,r,s,e[0],o[3]),s=m.calculateCompressionCycle(m.transformRoundTwo,u[20],s,t,n,r,e[5],o[0]),r=m.calculateCompressionCycle(m.transformRoundTwo,u[21],r,s,t,n,e[10],o[1]),n=m.calculateCompressionCycle(m.transformRoundTwo,u[22],n,r,s,t,e[15],o[2]),t=m.calculateCompressionCycle(m.transformRoundTwo,u[23],t,n,r,s,e[4],o[3]),s=m.calculateCompressionCycle(m.transformRoundTwo,u[24],s,t,n,r,e[9],o[0]),r=m.calculateCompressionCycle(m.transformRoundTwo,u[25],r,s,t,n,e[14],o[1]),n=m.calculateCompressionCycle(m.transformRoundTwo,u[26],n,r,s,t,e[3],o[2]),t=m.calculateCompressionCycle(m.transformRoundTwo,u[27],t,n,r,s,e[8],o[3]),s=m.calculateCompressionCycle(m.transformRoundTwo,u[28],s,t,n,r,e[13],o[0]),r=m.calculateCompressionCycle(m.transformRoundTwo,u[29],r,s,t,n,e[2],o[1]),n=m.calculateCompressionCycle(m.transformRoundTwo,u[30],n,r,s,t,e[7],o[2]),t=m.calculateCompressionCycle(m.transformRoundTwo,u[31],t,n,r,s,e[12],o[3]),s=m.calculateCompressionCycle(m.transformRoundThree,u[32],s,t,n,r,e[5],l[0]),r=m.calculateCompressionCycle(m.transformRoundThree,u[33],r,s,t,n,e[8],l[1]),n=m.calculateCompressionCycle(m.transformRoundThree,u[34],n,r,s,t,e[11],l[2]),t=m.calculateCompressionCycle(m.transformRoundThree,u[35],t,n,r,s,e[14],l[3]),s=m.calculateCompressionCycle(m.transformRoundThree,u[36],s,t,n,r,e[1],l[0]),r=m.calculateCompressionCycle(m.transformRoundThree,u[37],r,s,t,n,e[4],l[1]),n=m.calculateCompressionCycle(m.transformRoundThree,u[38],n,r,s,t,e[7],l[2]),t=m.calculateCompressionCycle(m.transformRoundThree,u[39],t,n,r,s,e[10],l[3]),s=m.calculateCompressionCycle(m.transformRoundThree,u[40],s,t,n,r,e[13],l[0]),r=m.calculateCompressionCycle(m.transformRoundThree,u[41],r,s,t,n,e[0],l[1]),n=m.calculateCompressionCycle(m.transformRoundThree,u[42],n,r,s,t,e[3],l[2]),t=m.calculateCompressionCycle(m.transformRoundThree,u[43],t,n,r,s,e[6],l[3]),s=m.calculateCompressionCycle(m.transformRoundThree,u[44],s,t,n,r,e[9],l[0]),r=m.calculateCompressionCycle(m.transformRoundThree,u[45],r,s,t,n,e[12],l[1]),n=m.calculateCompressionCycle(m.transformRoundThree,u[46],n,r,s,t,e[15],l[2]),t=m.calculateCompressionCycle(m.transformRoundThree,u[47],t,n,r,s,e[2],l[3]),s=m.calculateCompressionCycle(m.transformRoundFour,u[48],s,t,n,r,e[0],i[0]),r=m.calculateCompressionCycle(m.transformRoundFour,u[49],r,s,t,n,e[7],i[1]),n=m.calculateCompressionCycle(m.transformRoundFour,u[50],n,r,s,t,e[14],i[2]),t=m.calculateCompressionCycle(m.transformRoundFour,u[51],t,n,r,s,e[5],i[3]),s=m.calculateCompressionCycle(m.transformRoundFour,u[52],s,t,n,r,e[12],i[0]),r=m.calculateCompressionCycle(m.transformRoundFour,u[53],r,s,t,n,e[3],i[1]),n=m.calculateCompressionCycle(m.transformRoundFour,u[54],n,r,s,t,e[10],i[2]),t=m.calculateCompressionCycle(m.transformRoundFour,u[55],t,n,r,s,e[1],i[3]),s=m.calculateCompressionCycle(m.transformRoundFour,u[56],s,t,n,r,e[8],i[0]),r=m.calculateCompressionCycle(m.transformRoundFour,u[57],r,s,t,n,e[15],i[1]),n=m.calculateCompressionCycle(m.transformRoundFour,u[58],n,r,s,t,e[6],i[2]),t=m.calculateCompressionCycle(m.transformRoundFour,u[59],t,n,r,s,e[13],i[3]),s=m.calculateCompressionCycle(m.transformRoundFour,u[60],s,t,n,r,e[4],i[0]),r=m.calculateCompressionCycle(m.transformRoundFour,u[61],r,s,t,n,e[11],i[1]),n=m.calculateCompressionCycle(m.transformRoundFour,u[62],n,r,s,t,e[2],i[2]),t=m.calculateCompressionCycle(m.transformRoundFour,u[63],t,n,r,s,e[9],i[3]),this.state.hash[0]=this.state.hash[0]+s|0,this.state.hash[1]=this.state.hash[1]+t|0,this.state.hash[2]=this.state.hash[2]+n|0,this.state.hash[3]=this.state.hash[3]+r|0}}const d=512,C=128,y=new Uint32Array([19088743,2309737967]),p=new Uint32Array([1930543745,606457760]),g=new Uint32Array([1930543745,606457760,1681008740,883607783,3053736169,4016617409,3908772752,2376009457,3710809803,2794579391,215012923,741391425,529321832,587566986,1424354651,2296608605,1255221934,174940209,1048516283,2283941389,2331535133,1068829740,2572865815,2345819185,3363357149,80000563,997328492,2048217772,225391906,1662975947]),f=[17,18,21,31,67,89],R=[10,5,13,10,11,12,2,7,14,15,7,13,11,7,6,12],w=[11,24,9,16,15,9,27,15,6,2,29,8,15,5,31,9];class T extends e{static xorWord(e,s,t){return t[0]=e[0]^s[0],t[1]=e[1]^s[1],t}static andWord(e,s,t){return t[0]=e[0]&s[0],t[1]=e[1]&s[1],t}static shlWord(e,s,t){const n=e[0],r=e[1];return s>=32?(t[0]=r<<s-32,t[1]=0):(t[0]=n<<s|r>>>32-s,t[1]=r<<s),t}static shrWord(e,s,t){const n=e[0],r=e[1];return s>=32?(t[0]=0,t[1]=n>>>s-32):(t[0]=n>>>s,t[1]=n<<32-s|r>>>s),t}static bytesToWords(e){const s=e.length,t=Math.ceil(s/8),n=new Array(t);for(let r=0,a=0;a<t;r+=8,a++)n[a]=new Uint32Array([(e[r]||0)<<24|(e[r+1]||0)<<16|(e[r+2]||0)<<8|(e[r+3]||0),(e[r+4]||0)<<24|(e[r+5]||0)<<16|(e[r+6]||0)<<8|(e[r+7]||0)]);return n}static wordsToBytes(e){const s=e.length,t=new Uint8Array(8*s);for(let n=0;n<s;n++){const s=8*n,r=e[n][0],a=e[n][1];t[s]=r>>>24&255,t[s+1]=r>>>16&255,t[s+2]=r>>>8&255,t[s+3]=255&r,t[s+4]=a>>>24&255,t[s+5]=a>>>16&255,t[s+6]=a>>>8&255,t[s+7]=255&a}return t}static processCompression(e,s){let t=new Uint32Array([...y]);const n=e.map(e=>new Uint32Array(e)),r=new Uint32Array(2),a=new Uint32Array(2),o=new Uint32Array(2),l=new Uint32Array(2),i=new Uint32Array(2),c=new Uint32Array(2),h=new Uint32Array(2);for(let u=0;u<s;u++){const e=89+16*u;for(let s=0;s<16;s++){const c=e+s;r[0]=t[0],r[1]=t[1],T.xorWord(r,n[c-f[5]],r),T.xorWord(r,n[c-f[0]],r),T.andWord(n[c-f[1]],n[c-f[2]],a),T.xorWord(r,a,r),T.andWord(n[c-f[3]],n[c-f[4]],a),T.xorWord(r,a,r),T.shrWord(r,R[s],o),T.xorWord(r,o,r),T.shlWord(r,w[s],l),T.xorWord(r,l,i),n[c]=new Uint32Array(i)}T.shlWord(t,1,l),T.shrWord(t,63,o),T.xorWord(l,o,c),T.andWord(t,p,h),T.xorWord(c,h,t)}return n.slice(n.length-16)}static computeCompression(e,s,t,n,r,a,o,l,i,c,h){const u=new Uint32Array([(255&a)<<24|16777215&Math.floor(t/4294967296),4294967295&t]),m=new Uint32Array([(4095&c)<<16|(255&i)<<8|(15&r)<<4|(61440&n)>>12,(4095&n)<<20|(255&o)<<12|4095&l]),d=g.length/2+h.length+2+s.length+e.length,C=new Array(d);let y=0;for(let p=0;p<g.length;p+=2)C[y++]=new Uint32Array([g[p],g[p+1]]);for(let p=0;p<h.length;p++)C[y++]=h[p];C[y++]=u,C[y++]=m;for(let p=0;p<s.length;p++)C[y++]=s[p];for(let p=0;p<e.length;p++)C[y++]=e[p];return T.processCompression(C,c)}static padMessage(e,s){let t=0,n=e.length;if(0===n||n%s>0)for(0===n&&(n=1,t=8);n%s>0;)n++,t+=8;const r=new Uint8Array(n);return r.set(e),{paddedMessage:r,paddingLength:t}}static parallelCompression(e,s,t,n,r,a,o){const{paddedMessage:l,paddingLength:i}=T.padMessage(e,d),c=e.length<=d?1:0,h=T.bytesToWords(l),u=h.length/64,m=new Array(16*u);let C=0;for(let d=0;d<u;d++){const e=d===u-1?i:0,l=h.slice(64*d,64*(d+1)),y=T.computeCompression(l,[],d,e,c,s,r,t,n,a,o);for(let s=0;s<y.length;s++)m[C++]=y[s]}return T.wordsToBytes(m)}static sequentialCompression(e,s,t,n,r,a,o){const{paddedMessage:l,paddingLength:i}=T.padMessage(e,384),c=T.bytesToWords(l),h=c.length/48;let u=Array.from({length:16},()=>new Uint32Array([0,0]));for(let m=0;m<h;m++){const e=m===h-1?i:0,l=m===h-1?1:0,d=c.slice(48*m,48*(m+1));u=T.computeCompression(d,u,m,e,l,s,r,t,n,a,o)}return T.wordsToBytes(u)}constructor(e={}){super(e),this.hashSize=Math.max(1,Math.min(e.size||256,512)),this.keyBytes=e.key||new Uint8Array,this.levels=e.levels||64,this.reset()}finalize(){const e=this.engine();return super.reset(),e}engine(){const e=this.keyBytes.length,s=new Uint8Array(64);s.set(this.keyBytes.slice(0,64));const t=T.bytesToWords(s),n=Math.max(e>0?80:0,40+this.hashSize/4);let r=0,a=this.state.message;do{r++,a=r>this.levels?T.sequentialCompression(a,r,this.hashSize,this.levels,e,n,t):T.parallelCompression(a,r,this.hashSize,this.levels,e,n,t)}while(a.length!==C);const o=Math.ceil(this.hashSize/8),l=this.hashSize%8,i=a.slice(a.length-o);return l>0&&(i[o-1]&=255<<8-l&255),i}process(){}}function A(e,s,t){const r=function(e,s){switch(e){case"md2":return new n(s);case"md4":return new c(s);case"md5":return new m(s);case"md6":return new T(s);default:throw new Error(`Unsupported hasher name: ${e}`)}}(e,t);return r.update((new TextEncoder).encode(s)),r.finalize()}const U={name:"MD",category:"Hasher",description:"Calculates the message digest (hash) of the input using various algorithms.",spices:[{id:"algorithm",label:"Algorithm",type:"select",value:"md5",options:[{label:"MD2",value:"md2"},{label:"MD4",value:"md4"},{label:"MD5",value:"md5"},{label:"MD6",value:"md6"}]},{id:"rounds",label:"Rounds",type:"number",value:18,min:1,dependsOn:[{spiceId:"algorithm",value:"md2"}]},{id:"size",label:"Size",type:"number",value:256,min:1,max:512,dependsOn:[{spiceId:"algorithm",value:"md6"}]},{id:"levels",label:"Levels",type:"number",value:64,min:1,dependsOn:[{spiceId:"algorithm",value:"md6"}]},{id:"key",label:"Key",type:"string",value:"",dependsOn:[{spiceId:"algorithm",value:"md6"}]}],run:async(e,s)=>{const t=e.cast("string").value;if(!t.trim())return e.warning();const n={rounds:s.rounds,size:s.size,levels:s.levels,key:s.key?(new TextEncoder).encode(s.key):void 0},r=A(s.algorithm,t,n);return e.update(r).cast("hex")}};Baratie.ingredient.register(U)}();
